version: "3.5"
services:
  producer-1:
    container_name: producer-1
    image: bitnami/python:3.9
    command: "sh -c 'pip install -r requirements.txt && python producer.py'"
    ports:
      - "9999:9999" # JMX Exporter port
    networks:
      - kafka-network
    environment:
      BOOTSTRAP_SERVERS: kafka-0:9092
      TOPIC_NAME: orders
      GROUP_ID: orders-group
      EXTRA_ARGS: "-javaagent:/usr/app/jmx_prometheus_javaagent.jar=9999:/usr/app/prom-jmx-agent-config.yml"
    volumes:
      - .:/app
  producer-2:
      container_name: producer-2
      image: bitnami/python:3.9
      command: "sh -c 'pip install -r requirements.txt && python producer.py'"
      networks:
        - kafka-network
      environment:
        BOOTSTRAP_SERVERS: kafka-1:9092
        TOPIC_NAME: books
      volumes:
        - .:/app
  producer-3:
    container_name: producer-3
    image: bitnami/python:3.9
    command: "sh -c 'pip install -r requirements.txt && python producer.py'"
    networks:
      - kafka-network
    environment:
      BOOTSTRAP_SERVERS: kafka-2:9092
      TOPIC_NAME: your-topic
    volumes:
      - .:/app
      - /var/run/docker.sock:/var/run/docker.sock

networks:
  kafka-network:
    external: true
